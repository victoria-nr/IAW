
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://victoria-nr.github.io/IAW/Unidad%202/P2_4_proxy_inv_nginx/">
      
      
        <link rel="prev" href="../P2_3_autenticacion_nginx/">
      
      
        <link rel="next" href="../P2_5_HTTPS_nginx/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Práctica 2.4 – Proxy inverso con Nginx - Implantación de aplicaciones web</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-3NX5MD5C8H"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-3NX5MD5C8H",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-3NX5MD5C8H",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#practica-24-proxy-inverso-con-nginx" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Implantación de aplicaciones web" class="md-header__button md-logo" aria-label="Implantación de aplicaciones web" data-md-component="logo">
      
  <img src="../../assets/logocaminas.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Implantación de aplicaciones web
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Práctica 2.4 – Proxy inverso con Nginx
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="blue"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Implantación de aplicaciones web" class="md-nav__button md-logo" aria-label="Implantación de aplicaciones web" data-md-component="logo">
      
  <img src="../../assets/logocaminas.png" alt="logo">

    </a>
    Implantación de aplicaciones web
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unidad 1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Unidad 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201/Ud1_1_introModulo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción al módulo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prácticas
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Prácticas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201/P1_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    P1.1. Linux Server en AWSAcademy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201/P1_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    P1.2 Windows Server en AWSAcademy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201/P1_3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    P1.3. Conceder acceso a un segundo administrador
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201/P1_4_tallerGitIntro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Taller 1: Introducción a git y GitHub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201/P1_5_tallerGitRamasUniones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Taller 2: Git. Trabajando con ramas y uniones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%201/P1_6_tallerMarkdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Taller 3: Introducción a Markdown
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unidad 2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Unidad 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ud2_1_Imp_ArqWeb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1. Arquitecturas web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ud2_2_Func_app_web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2. Funcionamiento de una aplicación Web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ud2_3_ArqWeb_serweb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3. Implantación y administración de servidores web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ud2_4_Serv_web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4. Servidores web: Nginx vs Apache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ud2_5_Infraestructura_despliegue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.5. Infraestructura para el despliegue de aplicaciones web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ud2_6_HTTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.6. El protocolo HTTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ud2_7_HTTPS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.7. El protocolo HTTPS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" checked>
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prácticas
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Prácticas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../P2_1_nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 2.1 – Instalación y configuración de servidor web Nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../P2_2_sitios_virtuales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 2.2 – Creación de un sitio virtual
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../P2_3_autenticacion_nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 2.3 – Autenticación en Nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Práctica 2.4 – Proxy inverso con Nginx
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Práctica 2.4 – Proxy inverso con Nginx
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requisitos-antes-de-comenzar-la-practica" class="md-nav__link">
    <span class="md-ellipsis">
      Requisitos antes de comenzar la práctica
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introducción">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#que-es-un-servidor-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Qué es un servidor proxy?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#en-que-se-diferencia-un-proxy-inverso" class="md-nav__link">
    <span class="md-ellipsis">
      ¿En qué se diferencia un proxy inverso?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tarea" class="md-nav__link">
    <span class="md-ellipsis">
      Tarea
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tarea">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuraciones" class="md-nav__link">
    <span class="md-ellipsis">
      Configuraciones
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuraciones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuracion-servidor-web-nginx-de-la-practica-22" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración servidor web nginx de la Práctica 2.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracion-proxy-inverso-nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración proxy inverso Nginx
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comprobaciones" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobaciones
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comprobaciones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anadiendo-cabeceras" class="md-nav__link">
    <span class="md-ellipsis">
      Añadiendo cabeceras
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../P2_5_HTTPS_nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Practica 2.5 - Activación HTTPS en proxy inverso NGINX
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unidad 3
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Unidad 3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203/Ud3_1_App_Web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1. Implantación de aplicaciones web PHP.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prácticas
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Prácticas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203/P3_1_InstallLAMP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Practica 3.1 - Instalación de la pila LAMP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203/P3_2_PHPMyAdmin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 3.2: Herramientas relacionadas con la pila LAMP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203/P3_3_VirtualhostingApache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 3.3: VirtualHosting con Apache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203/P3_4_AppBookMedik/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 3.4: Implantación de la aplicación PHP BookMedik
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203/P3_4_AppBookMedik_extension_config_ini/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extensión de la práctica "Implantación de la aplicación PHP BookMedik"
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Unidad%203/P3_5_CMSWordPress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 3.5: Instalación del CMS WordPress
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="practica-24-proxy-inverso-con-nginx">Práctica 2.4 – Proxy inverso con Nginx</h1>
<h2 id="requisitos-antes-de-comenzar-la-practica">Requisitos antes de comenzar  la práctica</h2>
<div class="admonition danger">
<p class="admonition-title">Atención, importante antes de comenzar</p>
<ul>
<li>La práctica 2.2 ha de estar funcionando correctamente</li>
<li>No comenzar la práctica antes de tener la 2.2 <strong><em>funcionando y comprobada</em></strong></li>
</ul>
</div>
<h2 id="introduccion">Introducción</h2>
<h3 id="que-es-un-servidor-proxy">¿Qué es un servidor proxy?</h3>
<p>Un proxy de reenvío, a menudo llamado proxy, servidor proxy o proxy web, es un servidor que se encuentra frente a un grupo de máquinas cliente. Cuando esas máquinas realizan solicitudes a sitios y servicios en Internet, el servidor proxy intercepta esas solicitudes y luego se comunica con los servidores web en nombre de esos clientes, como un intermediario. </p>
<p>Por ejemplo, tomemos como ejemplo 3 máquinas involucradas en una comunicación típica de proxy de reenvío: </p>
<ul>
<li>
<p>A: Esta es la máquina del hogar de un usuario. </p>
</li>
<li>
<p>B: este es un servidor proxy de reenvío </p>
</li>
<li>
<p>C: este es el servidor de origen de un sitio web (donde se almacenan los datos del sitio web) </p>
</li>
</ul>
<p><img alt="" src="../P2_3/4.1-7.png" /></p>
<p>En una comunicación estándar por Internet, la máquina A se comunicaría directamente con la máquina C, con el cliente enviando solicitudes al servidor de origen y el servidor de origen respondiendo al cliente. Cuando hay un proxy de reenvío, A enviará solicitudes a B, que luego reenviará la solicitud a C. C enviará una respuesta a B, que reenviará la respuesta a A. </p>
<p>¿Por qué agregar este intermediario adicional a nuestra actividad en Internet? </p>
<p><img alt="" src="../P2_3/proxy.jpg" /></p>
<p>Hay algunas razones por las que uno podría querer usar un proxy de reenvío: </p>
<ul>
<li>
<p><strong><em>Para evitar restricciones de navegación estatales o institucionales</em></strong>: algunos gobiernos, escuelas y otras organizaciones usan firewalls para dar a sus usuarios acceso a una versión limitada de Internet. Se puede usar un proxy de reenvío para sortear estas restricciones, ya que permiten que el usuario se conecte al proxy en lugar de directamente a los sitios que está visitando. </p>
</li>
<li>
<p><strong><em>Para bloquear el acceso a cierto contenido</em></strong>: a la inversa, los proxies también se pueden configurar para bloquear el acceso de un grupo de usuarios a ciertos sitios. Por ejemplo, una red escolar puede estar configurada para conectarse a la web a través de un proxy que habilita reglas de filtrado de contenido, negándose a reenviar respuestas de Facebook y otros sitios de redes sociales. </p>
</li>
<li>
<p><strong><em>Para proteger su identidad en línea</em></strong>: en algunos casos, los usuarios habituales de Internet simplemente desean un mayor anonimato en línea, pero en otros casos, los usuarios de Internet viven en lugares donde el gobierno puede imponer graves consecuencias a los disidentes políticos. Criticar al gobierno en un foro web o en las redes sociales puede dar lugar a multas o encarcelamiento para estos usuarios. Si uno de estos disidentes usa un proxy de reenvío para conectarse a un sitio web donde publica comentarios políticamente sensibles, la dirección IP utilizada para publicar los comentarios será más difícil de rastrear hasta el disidente. Solo estará visible la dirección IP del servidor proxy. </p>
</li>
</ul>
<h3 id="en-que-se-diferencia-un-proxy-inverso">¿En qué se diferencia un proxy inverso?</h3>
<p>Estaríamos hablando del caso opuesto al anterior. </p>
<p>Un proxy inverso es un servidor que se encuentra frente a uno o más servidores web, interceptando las solicitudes de los clientes. Esto es diferente de un proxy de reenvío, donde el proxy se encuentra frente a los clientes. Con un proxy inverso, cuando los clientes envían solicitudes al servidor de un sitio web, esas solicitudes son interceptadas en la frontera de la red por el servidor proxy inverso. El servidor proxy inverso enviará solicitudes y recibirá respuestas del servidor del sitio web. </p>
<p>La diferencia entre un proxy directo y inverso es sutil pero importante. Una forma simplificada de resumir sería decir que un <strong>proxy de reenvío</strong> <u>se encuentra frente a un cliente y garantiza que ningún servidor de origen se comunique nunca directamente con ese cliente específico</u>. Por otro lado, un <strong>proxy inverso</strong> <u>se encuentra frente a un servidor de origen y garantiza que ningún cliente se comunique nunca directamente con ese servidor de origen</u>. </p>
<p>Una vez más, ilustremos nombrando las máquinas involucradas: </p>
<ul>
<li>
<p>D: cualquier número de ordenadores domésticos de los usuarios </p>
</li>
<li>
<p>E: este es un servidor proxy inverso </p>
</li>
<li>
<p>F: uno o más servidores de origen </p>
</li>
</ul>
<p><img alt="" src="../P2_3/4.1-8.png" /></p>
<p>Normalmente, todas las solicitudes de D irían directamente a F, y F enviaría respuestas directamente a D. Con un proxy inverso, todas las solicitudes de D irán directamente a E, y E enviará sus solicitudes y recibirá respuestas de F. E luego transmitirá las respuestas apropiadas a D. </p>
<p>A continuación se describen algunos de los beneficios de un proxy inverso: </p>
<ul>
<li>
<p><strong>Balanceo de carga</strong>: es posible que un sitio web popular que recibe millones de usuarios todos los días no pueda manejar todo el tráfico entrante del sitio con un solo servidor de origen. En cambio, el sitio se puede distribuir entre un grupo de servidores diferentes, todos manejando solicitudes para el mismo sitio. En este caso, un proxy inverso puede proporcionar una solución de balanceo de carga que distribuirá el tráfico entrante de manera uniforme entre los diferentes servidores para evitar que un solo servidor se sobrecargue. En el caso de que un servidor falle por completo, otros servidores pueden intensificar para manejar el tráfico. </p>
</li>
<li>
<p><strong>Protección contra ataques</strong>: con un proxy inverso en su lugar, un sitio web o servicio nunca necesita revelar la dirección IP de su (s) servidor (es) de origen. Esto hace que sea mucho más difícil para los atacantes aprovechar un ataque dirigido contra ellos, como un ataque DdoS. </p>
</li>
<li>
<p><strong>Almacenamiento en caché</strong>: un proxy inverso también puede almacenar contenido en caché , lo que resulta en un rendimiento más rápido. Por ejemplo, si un usuario en París visita un sitio web con proxy inverso con servidores web en Los Ángeles, el usuario podría conectarse a un servidor proxy inverso local en París, que luego tendrá que comunicarse con un servidor de origen en Los Ángeles. El servidor proxy luego puede almacenar en caché (o guardar temporalmente) los datos de respuesta. Los usuarios parisinos posteriores que naveguen por el sitio obtendrán la versión en caché local del servidor proxy inverso parisino, lo que dará como resultado un rendimiento mucho más rápido. </p>
</li>
<li>
<p><strong>Cifrado SSL</strong> - Cifrado y descifrado SSL (o TLS comunicaciones) para cada cliente pueden ser computacionalmente caro para un servidor de origen. Se puede configurar un proxy inverso para descifrar todas las solicitudes entrantes y cifrar todas las respuestas salientes, liberando valiosos recursos en el servidor de origen. </p>
</li>
</ul>
<p><img alt="" src="../P2_3/Reverse_Proxy.png" /></p>
<h2 id="tarea">Tarea</h2>
<h3 id="configuraciones">Configuraciones</h3>
<p>Vamos a configurar dos Debian con sendos servidores Nginx. </p>
<ul>
<li>
<p>Uno ya lo tenemos de la Práctica 2.2 y servirá la web de la tarea2 que ya hemos configurado. </p>
</li>
<li>
<p>Crearemos un nuevo servidor Debian en AWS, instalaremos nginx y lo configuraremos como proxy inverso.</p>
</li>
</ul>
<p>Realizaremos las peticiones HTTP desde el navegador web de nuestra máquina física/anfitrión hacia el proxy inverso, que nos redirigirá al servidor web original de la Práctica 2.2.</p>
<p>El diagrama de red quedaría así: </p>
<p><img alt="" src="../P2_3/p2.3.png" /></p>
<p>Para que todo quede más diferenciado y os quede más claro que la petición está pasando por el proxy inverso y llega al servidor web destino, vamos a hacer que cada uno de los servidores escuche las peticiones en un puerto distinto. </p>
<h4 id="configuracion-servidor-web-nginx-de-la-practica-22">Configuración servidor web nginx de la Práctica 2.2</h4>
<p>Vamos a cambiar el nombre que tuviera vuestra web por el de <code>webserver</code>, para ello: </p>
<ul>
<li>Cambiad el nombre del archivo de configuración del sitio, es decir, el fichero <code>tarea2</code> por <code>webserver</code>.</li>
<li>Cambiad el nombre del sitio web dentro de este archivo de configuración donde haga falta, que será en la directiva <code>server-name</code>. </li>
<li>En ese mismo fichero, en lugar de hacer que el servidor escuche en el puerto 80, cambiadlo al 8080. En la configuración de la instancia en AWS, tendrás que habilitar también las conexiones http al puerto 8080. Averigua cómo hacerlo y hazlo. Pista: deberás ir a grupos de seguridad y añadir una nueva regla de entrada.</li>
</ul>
<p>No os olvidéis de eliminar el link simbólico antiguo  con el comando <code>unlink nombre_del_link</code> dentro de la carpeta <code>sites-enabled</code> y crear el nuevo para el nuevo nombre de archivo. </p>
<p>Utiliza <code>nginx -t</code> para comprobar los cambios en la configuración. </p>
<p>Por último, reiniciad Nginx.</p>
<h4 id="configuracion-proxy-inverso-nginx">Configuración proxy inverso Nginx</h4>
<p>Crea una nueva instancia Debian y configura para que admita peticiones HTTP. Actualiza repositorios e instala nginx. A continuacion, crearemos un sitio virtual llamado <code>ejemplo-proxy</code>. Lo que queremos conseguir es que al acceder a <code>http://ejemplo-proxy</code> se acceda al proxy, que nos redirigirá a <code>http://webserver:8080</code>, el servidor web que acabamos de configurar para que escuche con ese nombre en el puerto 8080.</p>
<p>Para ello, en el nuevo servidor hay que seguir los siguientes pasos: </p>
<ul>
<li>
<p>Cread un archivo de configuración en <em>sites-available</em> con el nombre <code>ejemplo-proxy.conf</code>.</p>
</li>
<li>
<p>Este archivo de configuración será más simple, tendrá la siguiente forma:</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">server</span><span class="w"> </span>{<span class="w"> </span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="hll"><span class="w">    </span><span class="nb">listen</span><span class="w"> </span>__;<span class="w"> </span>
</span><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="hll"><span class="w">    </span><span class="nb">server_name</span><span class="w"> </span>____________;<span class="w"> </span>
</span><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="nb">location</span><span class="w"> </span>/<span class="w"> </span>{<span class="w"> </span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="hll"><span class="w">    </span><span class="nb">proxy_pass</span><span class="w"> </span>http://_________:____;<span class="w"> </span>
</span><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="err">}</span><span class="w"> </span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="err">}</span><span class="w"> </span>
</code></pre></div>
<p>Donde, <strong><em>mirando el diagrama de red y teniendo en cuenta la configuración hecha hasta ahora</em></strong>, debéis completar: </p>
<ul>
<li>
<p>El puerto donde está escuchando el proxy inverso </p>
</li>
<li>
<p>El nombre de vuestro dominio o sitio web original al que accedemos en el proxy </p>
</li>
<li>
<p>La directiva <code>proxy_pass</code> indica a dónde se van a redirigir las peticiones, esto es, al servidor web. Por tanto, debéis poner la IP (o mejor, el nombre de dominio, teniendo en cuenta que hay que modificar también el archivo <code>/etc/hosts</code> ) y número de puerto adecuados de vuestro sitio web configurado en el apartado anterior. </p>
</li>
<li>
<p>Crear el link simbólico pertinente </p>
</li>
</ul>
<p>Esto es para simular la situación en la que nosotros, como clientes, cuando accedamos a nuestro sitio web, no necesitemos saber cómo está todo configurado, sólo necesitamos saber el nombre de la web. </p>
<div class="admonition warning">
<p class="admonition-title">¡Atención, muy importante!</p>
<p><strong>Debéis modificar el archivo /etc/hosts de vuestra máquina local que configurastéis en la práctica 2.2. Si miráis el diagrama de red, ahora el nombre de vuestro sitio web se corresponderá con la IP de la nueva máquina que hace de proxy</strong>. Será ésta la encargada de redirigirnos automáticamente al verdadero sitio web.</p>
</div>
<h2 id="comprobaciones">Comprobaciones</h2>
<p>Si accedéis a vuestro sitio web, debéis poder seguir accediendo sin problemas. </p>
<ul>
<li>
<p>Comprobad en los access.log de los dos servidores que llega la petición </p>
</li>
<li>
<p>Comprobad además la petición y respuesta con las herramientas de desarrollador de Firefox. Pulsando F12 en el navegador os aparecerán estas herramientas</p>
</li>
</ul>
<p><img alt="" src="../P2_3/4.1-10.png" /></p>
<p>En la primera petición (marcada en rojo), utilizando el apartado “Red” (también marcado en rojo) y también en rojo está señalado dónde se puede ver la respuesta de la petición GET HTTP (200 OK). </p>
<p>También vemos las cabeceras que se incluyen en la petición (método GET) y en la respuesta a esta petición. </p>
<h3 id="anadiendo-cabeceras">Añadiendo cabeceras</h3>
<p>Además de haber mirado los logs, vamos a demostrar aún de forma más clara que la petición está pasando por el proxy inverso y que está llegando al servidor web y que vuelve por el mismo camino. </p>
<p>Si recordáis de teoría, el servidor web es capaz de añadir cabeceras en las respuestas a las peticiones. </p>
<p>Así pues, vamos a configurar tanto el proxy inverso como el servidor web para que añadan cada uno la cabecera “Host” que también vimos en teoría. </p>
<p>Para añadir cabeceras, en el archivo de configuración del sitio web debemos añadir dentro del bloque <code>location / { … }</code>  la directiva: </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">add_header</span><span class="w"> </span>Host<span class="w"> </span>nombre_del_host;
</code></pre></div>
<ol>
<li>
<p>Añadiremos primero esta cabecera únicamente en el archivo de configuración del sitio web del proxy inverso. El <code>nombre_del_host</code> será <code>proxy_inverso_vuestronombre</code>. </p>
</li>
<li>
<p>Reiniciamos Nginx </p>
</li>
<li>
<p>Comprobamos que podemos acceder al sitio web sin problemas.</p>
</li>
<li>
<p>Con las herramientas de desarrollador comprobamos que la petición ha pasado por el proxy inverso que ha añadido la cabecera en la respuesta: </p>
<p><img alt="" src="../P2_3/4.1-11.png" /></p>
</li>
<li>
<p>Hacemos lo propio con el servidor web. Esta vez el <code>nombre_del_host</code> será <code>servidor_web_vuestronombre</code>. </p>
<p>Si todo está configurado correctamente, al examinar las peticiones y respuestas, os aparecerán las dos cabeceras que han incluido en la respuesta tanto el proxy inverso como el servidor web.</p>
<p><img alt="" src="../P2_3/4.1-12.png" /></p>
</li>
</ol>
<p>Es muy importante que para realizar estas comprobaciones tengáis marcado el checkbox <em>Desactivar caché</em> o en <u>una ventana privada del navegador.</u></p>
<p><img alt="" src="../P2_3/4.1-13.png" /></p>
<p>Si no marcáis esto, la página se guardará en la memoria caché del navegador y no estaréis recibiendo la respuesta del servidor sino de la caché del navegador, lo que puede dar lugar a resultados erróneos. </p>
<!--
## Evaluación

| Criterio      | Puntuación                         |
| :--------- | :----------------------------------: |
|  Configuración correcta y completa del servidor web   |**3 puntos**  |
|  Configuración correcta y completa del proxy inverso| **4 puntos** |
| Comprobación del correcto funcionamento, incluyendo las cabeceras| **1 puntos**|
| Se ha prestado especial atención al formato del documento, utilizando la plantilla actualizada y haciendo un correcto uso del lenguaje técnico |**2 puntos** |

-->









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "toc.integrate", "search.highlight", "content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>